{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '46590037-17c17d616a892c92268aed1a1';\nconst BASE_URL = 'https://pixabay.com/api/';\naxios.defaults.baseURL = BASE_URL;\n\nexport const fetchImages = async (query, page = 1, perPage = 15) => {\n  const response = await axios.get(BASE_URL, {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: page,\n      per_page: perPage,\n    },\n  });\n  return response.data;\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const renderImages = images => {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n    <li class=\"gallery-item\">\n      <a href=\"${largeImageURL}\" class=\"gallery-link\">\n        <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" height=\"200\"/>\n      </a>\n      <div class=\"info\">\n        <p><b>Likes:</b> ${likes}</p>\n        <p><b>Views:</b> ${views}</p>\n        <p><b>Comments:</b> ${comments}</p>\n        <p><b>Downloads:</b> ${downloads}</p>\n      </div>\n    </li>\n  `\n    )\n    .join('');\n};\n\nlet lightbox;\n\nexport const initializeLightbox = () => {\n  if (lightbox) {\n    lightbox.refresh();\n  } else {\n    lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n  }\n};\n","import { fetchImages } from './js/pixabay-api.js';\nimport { renderImages, initializeLightbox } from './js/render-functions.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst refsEl = {\n  searchForm: document.querySelector('.search-form'),\n  inputForm: document.querySelector('.form-input'),\n  searchBtn: document.querySelector('.form-button'),\n  gallery: document.querySelector('.gallery'),\n  loaderEl: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.load-more'),\n};\n\nconst { searchForm, inputForm, searchBtn, gallery, loaderEl, loadMoreBtn } =\n  refsEl;\n\nlet query = '';\nlet page = 1;\nconst perPage = 15;\nlet totalHits = 0;\n\nsearchForm.addEventListener('submit', onSearchFormSubmit);\nloadMoreBtn.addEventListener('click', onLoadMoreClick);\n\nasync function onSearchFormSubmit(event) {\n  event.preventDefault();\n  query = event.target.elements.search.value.trim();\n  if (query === '') {\n    gallery.innerHTML = '';\n    event.target.reset();\n    iziToast.show({\n      message: 'Input field cannot be empty',\n      position: 'topRight',\n      timeout: 2000,\n      backgroundColor: '#EF4040',\n      messageColor: '#FAFAFB',\n      messageSize: '16px',\n      messageLineHeight: '1.5',\n      class: 'error',\n    });\n    return;\n  }\n\n  gallery.innerHTML = '';\n  page = 1;\n  loadMoreBtn.classList.add('is-hidden');\n  loaderEl.classList.remove('is-hidden');\n\n  try {\n    const imagesData = await fetchImages(query, page, perPage);\n    totalHits = imagesData.totalHits;\n    const totalPages = Math.ceil(totalHits / perPage);\n\n    if (totalHits === 0) {\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        timeout: 2000,\n        backgroundColor: '#EF4040',\n        messageColor: '#FAFAFB',\n        messageSize: '16px',\n        messageLineHeight: '1.5',\n        class: 'error',\n      });\n      return;\n    }\n    gallery.innerHTML = renderImages(imagesData.hits);\n    initializeLightbox();\n    event.target.reset();\n\n    if (page < totalPages) {\n      loadMoreBtn.classList.remove('is-hidden');\n    } else {\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 2000,\n        backgroundColor: '#EF4040',\n        messageColor: '#FAFAFB',\n        messageSize: '16px',\n        messageLineHeight: '1.5',\n        class: 'info',\n      });\n    }\n  } catch (error) {\n    console.log(error);\n    iziToast.show({\n      message: 'An error occurred while fetching images. Please try again.',\n      position: 'topRight',\n      timeout: 2000,\n      backgroundColor: '#EF4040',\n      messageColor: '#FAFAFB',\n      messageSize: '16px',\n      messageLineHeight: '1.5',\n      class: 'error',\n    });\n  } finally {\n    loaderEl.classList.add('is-hidden');\n  }\n}\n\nasync function onLoadMoreClick() {\n  page += 1;\n  loaderEl.classList.remove('is-hidden');\n\n  try {\n    const imagesData = await fetchImages(query, page, perPage);\n    const fragment = document.createDocumentFragment();\n\n    imagesData.hits.forEach(image => {\n      const imageElement = document.createElement('div');\n      imageElement.classList.add('gallery-item');\n      imageElement.innerHTML = renderImages([image]);\n      fragment.appendChild(imageElement);\n    });\n\n    gallery.appendChild(fragment);\n    initializeLightbox();\n    smoothScroll();\n\n    if (gallery.children.length >= totalHits) {\n      loadMoreBtn.classList.add('is-hidden');\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 2000,\n        backgroundColor: '#EF4040',\n        messageColor: '#FAFAFB',\n        messageSize: '16px',\n        messageLineHeight: '1.5',\n        class: 'info',\n      });\n    }\n  } catch (error) {\n    console.log(error);\n    iziToast.show({\n      message: 'An error occurred while fetching images. Please try again.',\n      position: 'topRight',\n      timeout: 5000,\n      backgroundColor: '#EF4040',\n      messageColor: '#FAFAFB',\n      messageSize: '16px',\n      messageLineHeight: '1.5',\n      class: 'error',\n    });\n  } finally {\n    loaderEl.classList.add('is-hidden');\n  }\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery-item')\n    .getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["API_KEY","BASE_URL","axios","fetchImages","query","page","perPage","renderImages","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","lightbox","initializeLightbox","SimpleLightbox","refsEl","searchForm","inputForm","searchBtn","gallery","loaderEl","loadMoreBtn","totalHits","onSearchFormSubmit","onLoadMoreClick","event","iziToast","imagesData","totalPages","error","fragment","image","imageElement","smoothScroll","cardHeight"],"mappings":"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"}